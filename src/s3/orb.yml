version: 2
description: A simple example of doing S3 deployment

orbs:
  aws-cli: circleci/aws-cli@volatile

executors:
  default: aws-cli/default

commands:
  deploy:
    description: "A simple encapsulation of doing an s3 sync"
    parameters:
      from:
        type: string
        description: A directory path local to the job to deploy to S3
      to:
        type: string
        description: A URI to an S3 bucket
      overwrite:
        default: "false"
        type: boolean
    steps:
      - aws-cli/install
      - aws-cli/configure:
          aws_access_key_id: $AWS_ACCESS_KEY_ID
          aws_secret_access_key: $AWS_SECRET_ACCESS_KEY
          region: $AWS_REGION

usage:
  version: 2
  orbs:
    s3: circleci/s3@volatile
  jobs:
    build:
      executor: s3/default
      steps:
        - s3/deploy:
            from: "somepath/thing"
            to: "S3_bucket_URI_goes_here"
            overwrite: "false"
